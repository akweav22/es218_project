---
title: "Ashley_HealthData"
author: "Ashley Weaver"
date: "5/1/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

```{r pre_process_race}
library(dplyr)
library(ggplot2)
library(tidyr)

hdat <- read.csv("R11371317_SL050.csv")
racedat <- read.csv("cc-est2018-alldata-22.csv")

racedat1 <- racedat %>% 
  filter(YEAR == 9,
         AGEGRP == 0) %>% 
  group_by(COUNTY) %>% 
  mutate(White = sum(WA_MALE, WA_FEMALE),
         Minority = TOT_POP - White,
         Perc_White = (White / TOT_POP) * 100,
         Perc_Minority = (Minority / TOT_POP) * 100) %>% 
  ungroup() %>% 
  select(STNAME, CTYNAME, TOT_POP, White, 
         Minority, Perc_White, Perc_Minority) %>% 
  mutate(LA_POP = sum(TOT_POP),
         LA_White_Perc = mean(Perc_White))

racedat2 <- racedat1 %>% 
  select(LA_White_Perc, STNAME) %>%
  pivot_wider(values_from = LA_White_Perc, names_from = STNAME) %>% 
  pivot_longer(values_to = "White", names_to = "Louisiana", cols = 1)

racedat2 <- racedat1 %>% 
  select(LA_White_Perc, STNAME) %>%
  pivot_wider(values_from = LA_White_Perc, names_from = STNAME) %>% 
  pivot_longer(values_to = "Value", names_to = "Louisiana", cols = 1)

CAracedat1 <- racedat1  %>% 
           filter(CTYNAME %in% c("East Baton Rouge Parish", 
                                "West Baton Rouge Parish",
                                "Ascension Parish",
                                "St. John the Baptist Parish",
                                "Iberville Parish",
                                "St. Charles Parish",
                                "Jefferson Parish",
                                "Orleans Parish"))
```

```{r plot_race}

ggplot(CAracedat1, aes(x = CTYNAME, y = Perc_White, fill = CTYNAME)) +
   geom_bar(stat="identity", width=1, color="white")  +
   labs(x = "County", y = "Percentage White", fill = "County")+
   geom_line()

ggplot(racedat2, aes(x = "", y = "Value", fill = "Louisiana")) +
  geom_bar(stat="identity", width=1, color="white") +
  coord_polar("y", start=0) +
  theme_void() +
  labs(fill = "Louisiana Races")

hdatdeath1 <- hdat %>% 
  filter(Geo_STATE == 22) %>% 
  select(LifeLost = "SE_T007_002", CTYNAME = "Geo_NAME") %>% 
  arrange(LifeLost)

ggplot(hdatdeath1) + aes(sample = LifeLost) + 
  geom_qq(distribution = qnorm) +
  geom_qq_line(line.p = c(0.25, 0.75), col = "blue") + ylab("Life Lost")

hdatchild <- hdat %>% 
  filter(Geo_STATE == 22) %>% 
  select(ChildMortality = "SE_NV006_002", CTYNAME = "Geo_NAME") %>% 
  arrange(ChildMortality)

ggplot(hdatchild) + aes(sample = ChildMortality) + 
  geom_qq(distribution = qnorm) +
  geom_qq_line(line.p = c(0.25, 0.75), col = "blue") + 
  ylab("Child Mortality Rate per 1,000 Population")

hdatobese <- hdat %>% 
  filter(Geo_STATE == 22) %>% 
  select(Perc_Obese = "SE_T012_003", CTYNAME = "Geo_NAME") %>% 
  arrange(Perc_Obese)

USmeanObesity <- mean(hdat$SE_T012_003)
USmeanChildMortality <- mean(hdat$SE_NV006_002, na.rm = TRUE)


```

![Source: Stepnick, Micheal. Industry & Infrastructure: Cancer Alley, LA and Detroit, MI. 2015](https://due-parsons.github.io/methods3-fall2015/img/industry-infrastructure-cancer-alley-la-and-detroit-mi/YXkdFV7.jpg)

